<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Task Manager Pro</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
   <style>
    body { background-color: #f4f7f6; color: #333; font-family: 'Segoe UI', sans-serif; }

    /* –ê–Ω–∏–º–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
    .card-stats {
        border: none;
        border-radius: 12px;
        color: white;
        transition: all 0.3s ease; /* –ü–ª–∞–≤–Ω–æ—Å—Ç—å */
        cursor: pointer;
    }

    /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É */
    .card-stats:hover {
        transform: translateY(-10px); /* –ü—Ä–∏–ø–æ–¥–Ω–∏–º–∞–µ–º */
        shadow: 0 10px 20px rgba(0,0,0,0.2); /* –£—Å–∏–ª–∏–≤–∞–µ–º —Ç–µ–Ω—å */
    }

    .bg-total { background: linear-gradient(45deg, #4e73df, #224abe); }
    .bg-todo { background: linear-gradient(45deg, #858796, #60616f); }
    .bg-doing { background: linear-gradient(45deg, #f6c23e, #f4b619); }
    .bg-done { background: linear-gradient(45deg, #1cc88a, #13855c); }

    /* –ê–Ω–∏–º–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã */
    .table tbody tr {
        transition: all 0.2s ease;
    }

    /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å—Ç—Ä–æ–∫–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
    .table tbody tr:hover {
        background-color: #f0f2f5 !important;
        transform: scale(1.005); /* –õ–µ–≥–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ */
        box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        z-index: 1;
    }

    .priority-high { border-left: 6px solid #e74a3b !important; }
    .priority-medium { border-left: 6px solid #f6c23e !important; }
    .priority-low { border-left: 6px solid #1cc88a !important; }

    .task-done { opacity: 0.5; background-color: #f8f9fa !important; }
    .task-done .task-title { text-decoration: line-through; }

    .btn-finish { border-radius: 20px; font-weight: bold; transition: 0.3s; }
    .btn-finish:hover { transform: scale(1.1); } /* –ö–Ω–æ–ø–∫–∞ —Ç–æ–∂–µ –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–∞ */
</style>
</head>
<body>
    <div class="container mt-5">
        <div class="d-flex justify-content-between align-items-center mb-5">
            <h1 class="fw-bold text-dark">üìã –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
            <a href="/admin/tasks/task/add/" class="btn btn-primary btn-lg shadow">+ –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</a>
        </div>

        <div class="row mb-5">
            <div class="col-md-3">
                <div class="card card-stats bg-total shadow h-100">
                    <div class="card-body text-center">
                        <div class="small opacity-75">–í—Å–µ–≥–æ</div>
                        <h2 class="display-6 fw-bold">{{ stats.total }}</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card card-stats bg-todo shadow h-100">
                    <div class="card-body text-center">
                        <div class="small opacity-75">–ù—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å</div>
                        <h2 class="display-6 fw-bold">{{ stats.todo }}</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card card-stats bg-doing shadow h-100">
                    <div class="card-body text-center">
                        <div class="small opacity-75">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</div>
                        <h2 class="display-6 fw-bold">{{ stats.doing }}</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card card-stats bg-done shadow h-100">
                    <div class="card-body text-center">
                        <div class="small opacity-75">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                        <h2 class="display-6 fw-bold">{{ stats.done }}</h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="card shadow-sm mb-4 border-0">
            <div class="card-body">
                <form method="GET" class="row g-2">
                    <div class="col-md-10">
                        <input type="text" name="search" class="form-control form-control-lg border-0 bg-light" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∑–∞–¥–∞—á–∞–º..." value="{{ search_query }}">
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-dark btn-lg w-100" type="submit">–ù–∞–π—Ç–∏</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="card shadow border-0 overflow-hidden">
            <table class="table table-hover align-middle mb-0">
                <thead class="table-light">
                    <tr>
                        <th class="ps-4">–ü—Ä–æ–µ–∫—Ç</th>
                        <th>–ó–∞–¥–∞—á–∞</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–µ–¥–ª–∞–π–Ω</th>
                        <th class="text-center">–î–µ–π—Å—Ç–≤–∏–µ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for task in tasks %}
                    <tr class="priority-{{ task.priority }} {% if task.status == 'done' %}task-done{% endif %}">
                        <td class="ps-4">
                            <span class="badge rounded-pill bg-light text-dark border">{{ task.project.name }}</span>
                        </td>
                        <td>
                            <div class="task-title fw-bold text-dark">{{ task.title }}</div>
                            <small class="text-muted">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å: {{ task.assigned_to.username|default:"‚Äî" }}</small>
                        </td>
                        <td>
                            {% if task.status == 'todo' %}<span class="badge bg-secondary">To Do</span>
                            {% elif task.status == 'doing' %}<span class="badge bg-warning text-dark">Doing</span>
                            {% else %}<span class="badge bg-success text-white">Done</span>{% endif %}
                        </td>
                        <td class="text-muted fw-bold">{{ task.deadline|date:"d M" }}</td>
                        <td class="text-center">
                            {% if task.status != 'done' %}
                                <a href="{% url 'complete_task' task.id %}" class="btn btn-finish btn-success btn-sm px-4">–ó–∞–≤–µ—Ä—à–∏—Ç—å</a>
                            {% else %}
                                <span class="text-success fw-bold">‚úì –ì–æ—Ç–æ–≤–æ</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="5" class="text-center py-5 text-muted">–ó–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>